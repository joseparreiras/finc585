The question is motivated by the original work of \citeauthor{hansen1982generalized}, contrasting the assumptions and empirical evidence for consumption-based asset pricing obtained via GMM versus maximum likelihood. 

I have posted quarterly data in a ﬁle labeled \texttt{HansenSingletondata.xlsx}, containing time series on U.S. aggregate real private consumption and real value of the S\&P500 index covering 1958:Q1 to 2016:Q4.

Consider a representative agent who maximizes utility,
\[
    \sum_{t=0}^\infty \beta^t u(C_t)
\]
subject to the budget constraint:
\[
    W_{t+1}=(W_t-C_t) \cdot R_{t+1}^m
\]
where \(C_t\) is real consumption, \(W_t\) is real wealth, \(R_{t+1}^m\) is the gross real return on the market portfolio, which is a weighted sum of individual asset returns. That is, \(R_{t+1}^m = \sum_i \alpha^iR_{t+1}^i\), \(\alpha^i\) is the weight of asset \(i\) in the market portfolio , and \(R_{t+1}^i\) is gross real return on asset \(i\).

Optimization on the part of the agent implies that,
\[
    u^\prime(C_t) = \E[t]{\beta R_{t+1}^m u^\prime(C_{t+1})}
\]
The left hand side of the above Euler equation is the increased utility from consuming one more unit of goods today. The right hand side is equal to the expectation of the present value of the increased utility, if the consumer invests one unit in the market portfolio today and consumes the gross return tomorrow. In equilibrium, the equality holds.

Let the utility function be given in terms of power utility (CRRA),
\[
    u(C_t) = \frac{C_t^{1-\gamma}-1}{1-\gamma}    
\]
Then the above Euler equation becomes,
\[
    1 = \E[t]\left[R^m_{t+1}\beta\left(\frac{C_{t+1}}{C_t}\right)^{-\gamma}\right]
\]
Rewrite the above equation, letting \(F_t\) denote all information available at time \(t\),
\begin{equation}
    \label{eq:eq1}
    \E{R^m_{t+1}\beta\left(\frac{C_{t+1}}{C_t}\right)^{-\gamma}-1 \Bigg\vert F_t} = 0
\end{equation}
\begin{enumerate}[label = \Alph*)]
    \item \label{item:jcriterion} First, we do something unusual, partially to display the versatility of GMM, but also to guide us towards good starting values for a traditional GMM procedure. Equation~\ref{eq:eq1} contains two parameters and translates into one (unconditional) moment condition. You will impose speciﬁc values on these parameters and check if the resulting moment condition is close to be satisﬁed – without estimating any parameters. Simply ﬁx \(\beta = 0.99\) and, for a grid of likely \(\gamma\) values, compute the GMM criterion function. That is, for each value of \(\gamma\) , compute the J-criterion using an eﬃcient GMM procedure. Estimate the spectral density for the moment condition at frequency zero (the long-run variance) using a Bartlett (Newey-West) kernel with a cut-off' parameter that is appropriate given the persistence in the data. Plot the value of the criterion function for the diﬀerent values of \(\gamma\). Discuss the results.
    \item \label{item:overidentified} Repeat the procedure in question \ref{item:jcriterion}, but letting \(F_t\) be represented by the instrument set: \(Z_t = \left(1, C_{t-1}, R^m_{t-1}\right)\), i.e., a constant and one-quarter lags of consumption growth \(C_{t-1}\)  and real returns. You are now exploiting over-identifying restrictions generated by the model.
    \item \label{item:estimate} Let us now try to perform actual parameter estimation with GMM. You have two free parameters, so you have to include moment conditions generated from (non-constant) instruments. Initially, estimate the system using the instruments in question \ref{item:overidentified}. You should now have a sense of reasonable values for the parameter vector, so you should have a good candidate for the original weighting matrix and do not have to estimate it using, say, the identity matrix. Report the parameter estimates, standard errors, and the J-test for the ﬁt of the over-identifying restriction(s).
    \item Expand the instrument set in question \ref{item:estimate} to include two, three, and four lags of the consumption growth and market return. For each set of (two) additional instruments, repeat the GMM estimation and report the results. In this case, you must obtain estimates for the weighting matrix in an initial step.
\end{enumerate}
